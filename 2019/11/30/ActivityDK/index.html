<!DOCTYPE html>
<html lang="zh-Hans">


<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="author" content="robin">
  
  
    <meta name="keywords" content="Basics,Activity," />
  
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <title>Activity知识详解 ~ Robin</title>
  <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.10.2/css/all.min.css"  >
<link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/css/bootstrap.min.css"  >
<link rel="stylesheet" href="https://cdn.staticfile.org/mdbootstrap/4.8.9/css/mdb.min.css"  >
<link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/3.0.1/github-markdown.min.css"  >

<link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css">


  <link rel="stylesheet" href="/lib/prettify/tomorrow-night-eighties.min.css"  >


  <link rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css"  >

<link rel="stylesheet" href="/css/main.css"  >
<script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
  <style type="text/css">
    .banner-bg {
      
        background-image: url('/img/default.png');
      
      background-position: center;
      background-repeat: repeat-y;
      background-size: cover;
      background-attachment: fixed;
    }
  </style>
<meta name="generator" content="Hexo 4.2.0"></head>

<body class="banner-bg">
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Robin</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/">主页</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/reading/">读书</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/photo">相册</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">归档</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">标签</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">关于</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>


</nav>

    <div class="view intro-2 rgba-black-slight" id="background">
      <div class="full-bg-img">
        <div class="mask flex-center">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>
            
              <br>
              <p class="mt-3">
                <i class="far fa-calendar-alt"></i>
                <span class="post-date">2019-11-30&nbsp;|&nbsp;</span>
                <i class="far fa-chart-bar"></i>
                <span class="post-count">2.7k</span>字&nbsp;|&nbsp;
                <i class="far fa-clock"></i>
                <span class="post-count">9</span>分钟
                
                  <span id="busuanzi_container_page_pv" style="display:none">
                    &nbsp;|&nbsp;
                    <i class="far fa-eye"></i>
                    <span id="busuanzi_value_page_pv"></span>次
                  </span>
                
              </p>
            
          </div>
          
        </div>
      </div>
    </div>
  </header>
  <main id="mainContent" class="rgba-black-slight">
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="py-5 z-depth-3" id="board">
        <div class="post-content mx-auto" id="post">
          <div class="markdown-body">
            <a id="more"></a>

<h1 id="Activity知识点详解"><a href="#Activity知识点详解" class="headerlink" title="Activity知识点详解"></a>Activity知识点详解</h1><h2 id="一、什么是Activity"><a href="#一、什么是Activity" class="headerlink" title="一、什么是Activity"></a>一、什么是Activity</h2><p>官方解释：</p>
<blockquote>
<p>The Activity class is a crucial component of an Android app, and the way activities are launched and put together is a fundamental part of the platform’s application model. Unlike programming paradigms in which apps are launched with amain()method, the Android system initiates code in an  Activity instance by invoking specific callback methods that correspond to specific stages of its lifecycle.<br>Activity是Android应用的重要组成部分，它的启动和组合方式是Android应用程序模型的一个基本部分。与使用 main ()方法启动应用程序的编程范例不同，Android 系统通过调用与其生命周期的特定阶段相对应的特定回调方法来启动 Activity 实例中的代码。<br>我们在日常的开发中接触最多的可能就是Activity了，对于Activity我的理解是它作为Android四大组件之一，主要是给我们提供界面的展示和用户交互。。这里要说下Android的四大组件，Activity、Service、Brocast、ContentProvider功能各不相同但是称它们为四大组件主要是它们四个都是Android应用的入口。我们都知道Java是采用main ()方法启动应用程序的，但是Android并没有采用这种方式，Android设计了四个组件以这些组件为入口来启动一个Android应用。</p>
</blockquote>
<h2 id="二、生命周期"><a href="#二、生命周期" class="headerlink" title="二、生命周期"></a>二、生命周期</h2><p>生命周期作为Activity老生常谈的知识点是我们必须要熟练掌握的。这里要分两种情况去理解掌握：正常情况下的生命周期和异常情况下的生命周期。</p>
<h3 id="正常情况下的生命周期"><a href="#正常情况下的生命周期" class="headerlink" title="正常情况下的生命周期"></a>正常情况下的生命周期</h3><p>这可以说是Activity最基本的知识点了在此就不展开了，贴张图<br><img src="https://developer.android.google.cn/images/components/intent-filters_2x.png" srcset="/img/loading.gif" alt="Activity生命周期"></p>
<p>再次补充一个关于生命周期的问题就是处于哪些生命周期时是可以被杀死的。<br> onCreate、onStart()、onRestart()、onResume()当Activity处于这些生命周期时是不可被kill的。onPause()在Honeycomb（3.X版本）之前是可以被kill的，而从Honeycomb开始系统在Activity回调onStop()<br>之前是不会杀死Activity的，因为这样可以确保在异常情况下onsaveinstancestate被调用，保存状态。<br>（Android P开始onsaveinstancestate在onStop()之后被调用）</p>
<h3 id="异常情况下的生命周期"><a href="#异常情况下的生命周期" class="headerlink" title="异常情况下的生命周期"></a>异常情况下的生命周期</h3><p>我们主要注意以下两种情况下的生命周期：</p>
<h4 id="系统配置发生变化"><a href="#系统配置发生变化" class="headerlink" title="系统配置发生变化"></a>系统配置发生变化</h4><p>比如常见的如屏幕方向发生变化，配置发生变化是会导致Activity销毁重建的，如果我们想保持之前的Activity不被销毁那么我们可以在manifest中设置对应的配置信息 ，之后当其变化时会触发onConfigurationChanged回调此时是不会销毁重建的。但是要注意的是触发回调时当前组件（Activity）必须还在运行 如果组件被暂停 那么是不会触发回调的 。</p>
<h4 id="内存紧张导致Activity被杀死"><a href="#内存紧张导致Activity被杀死" class="headerlink" title="内存紧张导致Activity被杀死"></a>内存紧张导致Activity被杀死</h4><p>因为Android总体资源有限当内存紧张时系统会根据一定的优先级杀死一些Activity。这里的优先级依次是：前台Activity&gt;可见Activity&gt;后台Activity&gt;空进程。</p>
<p>除此之外我们还要了解onsaveinstancestate/onrestoreinstancestate回调。<br>onsaveinstancestate是Activity因为异常被系统kill时用来保存当前Activity的有关状态和数据的，我们也可以在该回调中保存我们想要保存的数据以防止Activity因为异常被杀死而丢失数据。之后系统会在合适的时机重建该Activity此时就会触发onrestoreinstancestate回调，在该回调里我们可以拿到之前保存的状态和数据进行恢复（在oncreate中也可以拿到保存的数据不过需要进行判空，所以还是推荐在onrestoreinstancestate进行恢复）。</p>
<p>最后关于这两个函数的回调时机，系统版本不同会有一些差异：<br>1、 api &lt; 11，onSaveInstance在onPause之前执行<br>2、11 &lt;= api &lt; 28，onSaveInstance在onPause之后，onStop之前执行<br>3、api &gt;= 28，onSaveInstance在onStop之后执行</p>
<h2 id="三、启动方式"><a href="#三、启动方式" class="headerlink" title="三、启动方式"></a>三、启动方式</h2><h3 id="分类一"><a href="#分类一" class="headerlink" title="分类一"></a>分类一</h3><h4 id="显示启动"><a href="#显示启动" class="headerlink" title="显示启动"></a>显示启动</h4><p>指明ComponentName有明确的启动目标</p>
<h4 id="隐式启动"><a href="#隐式启动" class="headerlink" title="隐式启动"></a>隐式启动</h4><p>未指明ComponentName，通过匹配intentfilter找到可以启动的目标</p>
<h3 id="分类二"><a href="#分类二" class="headerlink" title="分类二"></a>分类二</h3><h4 id="不带返回值"><a href="#不带返回值" class="headerlink" title="不带返回值"></a>不带返回值</h4><p>通过startActivity</p>
<h4 id="带返回值"><a href="#带返回值" class="headerlink" title="带返回值"></a>带返回值</h4><p>startActivityForResult启动并在onActivityResult中接收返回的结果。</p>
<h2 id="四、任务栈"><a href="#四、任务栈" class="headerlink" title="四、任务栈"></a>四、任务栈</h2><p>Task是用户在执行某项任务时与之交互的Activity的集合。按照每个Activity打开的顺序排列在一个堆栈（先进后出）。一般来说处在栈顶的Activity是正在前台的Activity。<br>总结Activity和Task的默认行为:</p>
<ul>
<li>当Activitya 启动Activity b 时，Activity a 停止，但系统保持其状态(如滚动位置和输入到表单中的文本)。 如果用户按下Back键回来那么a 恢复其状态，b被弹出Task并被销毁。</li>
<li>当用户通过按下Home button当前Activity被停止并且它的任务进入后台。 系统保留任务中每个Activity的状态。 如果用户稍后通过选择启动该Task的启动图标恢复该任务，则该Task将到达前台并恢复堆栈顶部的Activity。</li>
<li>Activity可以被多次实例化，同时可以从其他Task中实例化</li>
</ul>
<p>一般而言我们不需要干预Task的默认行为，但是我们也可以通过以下方法去干预：</p>
<h3 id="taskAffinity"><a href="#taskAffinity" class="headerlink" title="taskAffinity"></a>taskAffinity</h3><p>Affinity表示Activity希望属于哪个Task。 默认情况下，来自同一个应用程序的所有Activity彼此都有相同的Affinity。可以设置Taskaffinity 属性来自定义Affinity。task自身的affinity决定于根Activity的affinity值也就是说同一个task中的所有Activity具有相同的affinity。<br>affinity在什么场合应用呢？<br>1.根据affinity重新为Activity选择宿主task（与allowTaskReparenting属性配合工作）；<br>2.启动一个Activity过程中Intent使用了FLAG_ACTIVITY_NEW_TASK标记，根据affinity查找或创建一个新的具有对应affinity的task<br>Affinity还有两点要注意：<br>1、根activity的taskAffinity可以决定task的“名字”，activity在启动时和re-parent时需要根据taskAffinity来确定该activity会出现在哪个task<br>2、优先级是activity中指定的taskAffinity&gt;application中指定的taskAffinity&gt;默认的包名</p>
<h3 id="launchMode"><a href="#launchMode" class="headerlink" title="launchMode"></a>launchMode</h3><p>Android提供了四种启动模式：</p>
<ul>
<li><p>standard<br>默认模式 该模式下每次启动activity都会创建新的activity实例。特殊情况，如果在Service或Application中启动一个Activity，其并没有所谓的任务栈，可以使用标记位Flag来解决。解决办法：为待启动的Activity指定FLAG_ACTIVITY_NEW_TASK标记位，创建一个新栈。</p>
</li>
<li><p>singleTop<br>启动一个activity如果该activity实例已经已在栈顶则复用并回调onnewintent。应用场景 推送跳转activity</p>
</li>
<li><p>singleTask<br>启动一个activity时会先找自己所属的Task，如果该Task已经存在那么查看Task中是否有该activity实例 有则复用并回调onnewintent<br>如果所属的Task还未创建那么就先创建Task然后再创建Activity实例并入栈 所以说singleTask 启动模式的activity 是全局单例的。应用场景 app主页</p>
</li>
<li><p>singleInstance<br>可以看做是singleTask的加强版，改启动模式下每次都会启动一个新的Task并将activity实例放到Task 并且Task中只有这一个activity实例。应用场景 呼叫来电。</p>
<h3 id="activity-attributes或者intent-flags"><a href="#activity-attributes或者intent-flags" class="headerlink" title="activity attributes或者intent flags"></a>activity attributes或者intent flags</h3></li>
<li><p>android:allowTaskReparenting<br>这个属性用来标记一个Activity实例在当前应用退居后台后，是否能从启动它的那个task移动到有共同affinity的task，“true”表示可以移动，“false”表示它必须呆在当前应用的task中，默认值为false 重新宿主的操作发生在应用退后台再次重启过程中</p>
</li>
<li><p>android:alwaysRetainTaskState<br>如果用户长时间离开Task，系统将清除除根Activity以外的所有Activity。 当用户再次返回Task时，只恢复根Activity。但是设置该属性为true后就不会发生清除，即使在很长一段时间之后，任务仍然保留其堆栈中的所有活动。</p>
</li>
<li><p>android:clearTaskOnLaunch<br>在Task的根Activity中，只要用户离开Task并返回到该Task，堆栈就会被清除到根Activity。用户总是返回到Task的初始状态，即使离开Task只有一会儿。</p>
</li>
<li><p>android: finishOnTaskLaunch<br>它作用于一个单一的Activity，而不是一个完整的Task。 它会导致任何Activity消失，包括根Activity。用户离开，然后返回到Task，则该Task不再存在。</p>
</li>
<li><p>FLAG_ACTIVITY_NEW_TASK<br>其效果与指定Activity为singleTask模式一致。系统会寻找或创建一个新的task来放置目标Activity，寻找时依据目标Activity的taskAffinity属性进行匹配，如果找到一个task的taskAffinity与之相同，就将目标Activity压入此task中，如果查找无果，则创建一个新的task，并将该task的taskAffinity设置为目标Activity的taskActivity，将目标Activity放置于此task</p>
</li>
<li><p>FLAG_ACTIVITY_SINGLE_TOP<br>其效果与指定Activity为singleTop模式一致。</p>
</li>
<li><p>FLAG_ACTIVITY_CLEAR_TOP<br>具有此标记位的Activity，当它启动时，在同一个任务栈中所有位于它上面的Activity都要出栈。如果和singleTask模式一起出现，若被启动的Activity已经存在栈中，则清除其之上的Activity，并调用该Activity的onNewIntent方法。如果被启动的Activity采用standard模式，那么该Activity连同之上的所有Activity出栈，然后创建新的Activity实例并压入栈中。如果和FLAG_ACTIVITY_NEW_TASK 一起使用时，则是一种在另一个Task中定位现有Activity并将其放置在能够响应该意图的位置的方法。</p>
</li>
<li><p>FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET<br>如果一个Intent中包含此属性，则它转向的那个Activity以及在那个Activity其上的所有Activity都会在task重置时被清除出task</p>
</li>
</ul>
<p>最后说明下activity启动时如何选择task：</p>
<ol>
<li><p>先判断target activity能否在新task中启动<br>singleTask/singleInstance的activity本身具有在新task中启动的能力，standard/singleTop的activity要想拥有在新task中启动的能力，需要在设置Intent.FLAG_ACTIVITY_NEW_TASK</p>
</li>
<li><p>判断target activity所在task<br>找一个taskAffinity的task去启动，找不到就新建一个（这里会忽略了singleInstance独占的task）</p>
</li>
<li><p>根据TargetActivity的启动模式判断会如何启动</p>
</li>
</ol>
<h2 id="五、相关问题"><a href="#五、相关问题" class="headerlink" title="五、相关问题"></a>五、相关问题</h2><h3 id="onWindowFocusChanged"><a href="#onWindowFocusChanged" class="headerlink" title="onWindowFocusChanged"></a>onWindowFocusChanged</h3><p>在Activity窗口获得或失去焦点时被调用，<br>1、创建时首次呈现在用户面前；<br>2、当前Activity被其他Activity覆盖；<br>3、当前Activity转到其他Activity或按Home键回到主屏，自身退居后台；<br>4、用户退出当前Activity。</p>
<p>以上几种情况都会调用onWindowFocusChanged，并且当Activity被创建时是在onResume之后被调用，当Activity被覆盖或者退居后台或者当前Activity退出时，它是在onPause之后被调用<br>这个方法在某种场合下还是很有用的，例如程序启动时想要获取视特定视图组件的尺寸大小，在onCreate中可能无法取到，因为窗口Window对象还没创建完成，这个时候我们就需要在onWindowFocusChanged里获取</p>
<h3 id="其他应用问题："><a href="#其他应用问题：" class="headerlink" title="其他应用问题："></a>其他应用问题：</h3><ol>
<li>activity间传递数据</li>
<li>知晓当前activity</li>
<li>关闭所有activity</li>
<li>双击退出app</li>
<li>保存activity状态<h3 id="面试常见知识点"><a href="#面试常见知识点" class="headerlink" title="面试常见知识点"></a>面试常见知识点</h3>Activity A跳转到Activity B 两者经历怎样的生命周期<br>未配置configchanges情况下屏幕发生旋转时 当前Activity的生命周期是怎样变化的</li>
</ol>

            <hr>
          </div>
          <br>
          <div>
            <div id="post-tag">
              
              <span>
                <i class="iconfont icon-tag"></i>
                
                  <a class="hover-with-bg" href="/tags/Basics">Basics</a>
                
                  <a class="hover-with-bg" href="/tags/Activity">Activity</a>
                
              </span>
            </div>
            
              <div id="post-note">
                <div><strong>本文作者：</strong><a href="/">myname</a></div>
                <div><strong>本文链接：</strong><a href="http://yoursite.com/2019/11/30/ActivityDK/">http://yoursite.com/2019/11/30/ActivityDK/</a></div>
                <div><strong>版权声明：</strong>本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="nofollow noopener noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</div>
              </div>
            
            
              <div id="post-nav" class="container">
                  <div class="row">
                    
                      <a href="/2019/12/05/androidstart/" id="post-nav-prev" class="col">
                        <i class="fas fa-arrow-left"></i>
                        <span class="post-nav-title">Android系统启动过程分析</span>
                      </a>
                    
                    
                      <a href="/2019/11/24/Okhttp4/" id="post-nav-next" class="col">
                        <span class="post-nav-title">Okhttp解析之—okhttp缓存机制</span>
                        <i class="fas fa-arrow-right"></i>
                      </a>
                    
                  </div>
                </div>
            
          </div>
        </div>

        <!-- custom -->
        

        <!-- Comments -->
        <div class="col-lg-10 mx-auto nopadding-md">
          <div class="container comments mx-auto" id="comments">
            
          </div>
        </div>

      </div>
    </div>
    <div class="d-none d-lg-block col-lg-2 toc-container">
      
  <div id="toc">
    <p class="h4"><i class="far fa-list-alt"></i>&nbsp;TOC</p>
    <div id="tocbot"></div>
  </div>


    </div>
  </div>
</div>





    
  </main>
  
<div id="sidebar" class="sidebar-hide">
  <span class="sidebar-button sidebar-button-shift" id="toggle-sidebar" >
    <i class="fa fa-arrow-right on" aria-hidden="true"></i>
  </span>
  <div class="sidebar-overlay"></div>
  <div class="sidebar-intrude">
    <div class="sidebar-avatar">
      <img src="/img/favicon.png" srcset="/img/favicon.png" alt="avatar"/>
    </div>
    <div class="text-center sidebar-about">
      <p class="h3 sidebar-author">Robin</p>
      <p class="sidebar-subtitle"></p>
      
        <a href="https://github.com" class="h4" target="_blank">
          <i class="fab fa-github" aria-hidden="true"></i>
        </a>
        &nbsp;&nbsp;
      
        <a href="https://twitter.com" class="h4" target="_blank">
          <i class="fab fa-twitter" aria-hidden="true"></i>
        </a>
        &nbsp;&nbsp;
      
        <a href="mailto:example@example.com" class="h4" target="_blank">
          <i class="fas fa-envelope" aria-hidden="true"></i>
        </a>
        &nbsp;&nbsp;
      
    </div>
    <div class="sidebar-friend">
      <p class="h6 sidebar-friend-title">
        <span class="sidebar-label-left"><i class="fas fa-user-friends"></i></span>
        <span class="sidebar-label">友情链接</span>
      </p>
      <ul class="list-group">
        
          <a href="https://example.com/" target="_blank">
            <li class="list-group-item">
              <i class="fas fa-quote-left"></i>&nbsp;
              friendname
            </li>
          </a>
        
    </ul>
    </div>
  </div>
</div>


  
    <a class="z-depth-1" id="scroll-top-button" href="#" role="button">
      <i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i>
    </a>
  
  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  
  <div id="footerContent"  class="rgba-black-slight">
<footer class="pt-5">
  <div class="text-center py-3">
  

    
      <div class="footer-copyright">
        
          ©2020&nbsp;robin
        
        
          
            <i class="iconfont icon-love"></i>
          
          <span>运转了<span id="runtime"></span>天</span>
        
      </div>
    

    

    

    
    
  </div>
</footer>
</div>
<!-- SCRIPTS -->
<script src="https://cdn.staticfile.org/popper.js/1.15.0/umd/popper.min.js" ></script>
<script src="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/js/bootstrap.min.js" ></script>
<script src="https://cdn.staticfile.org/mdbootstrap/4.8.9/js/mdb.min.js" ></script>
<script src="/js/main.js" ></script>

  <script src="/js/lazyload.js" ></script>


  
    <script src="https://cdn.staticfile.org/tocbot/4.8.0/tocbot.min.js" ></script>
  
  <script src="/js/post.js" ></script>

<!-- Plugins -->

  <script src="https://cdn.staticfile.org/prettify/r298/prettify.min.js" ></script>
  <script type="text/javascript">
    $(document).ready(function () {
      $('pre').addClass('prettyprint  linenums');
      prettyPrint();
    })
  </script>


  <script src="https://cdn.staticfile.org/typed.js/2.0.10/typed.min.js" ></script>
  <script type="text/javascript">
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "Activity知识详解&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>


  <script src="https://cdn.staticfile.org/anchor-js/4.2.0/anchor.min.js" ></script>
  <script type="text/javascript">
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>


  <script src="/js/local-search.js" ></script>
  <script type="text/javascript">
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      getSearchFile(path);
      this.onclick = null
    }
  </script>


  <script src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <script type="text/javascript">
  /* Fancybox */
  var setupFancybox = function () {
    $("#post img:not(.no-zoom img, img[no-zoom])").each(function() {
    var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      $(this).wrap(element);
    });
  };
  setupFancybox();
  </script>




  <!-- 首页文章列表随机图片 -->
  <script type="text/javascript">
    $("img.image_random").each(function(){
      
        var xjhUrl = "//img.xjh.me/random_img.php?return=json";
      
      var _this = $(this);
      $.get(xjhUrl,function(data,status){
        if(status === "success"){
          if(data.result === 200){
            _this[0].src = data.img;
          }
        }
      });
    });
  </script>




  <script async src="//cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js" ></script>
  


  
  
    <script type="text/javascript">
      //定义获取词语下标
      var a_idx = 0;
      jQuery(document).ready(function ($) {
        //点击body时触发事件
        $("body").click(function (e) {
          //需要显示的词语
          var a = new Array("富强", "民主", "文明", "和谐", "自由", "平等", "公正", "法治", "爱国", "敬业", "诚信", "友善");
          //设置词语给span标签
          var $i = $("<span/>").text(a[a_idx]);
          //下标等于原来下标+1  余 词语总数
          a_idx = (a_idx + 1) % a.length;
          //获取鼠标指针的位置，分别相对于文档的左和右边缘。
          //获取x和y的指针坐标
          var x = e.pageX, y = e.pageY;
          //在鼠标的指针的位置给$i定义的span标签添加css样式
          $i.css({
            "z-index": 999,
            "top": y - 20,
            "left": x,
            "position": "absolute",
            "font-weight": "bold",
            "color": rand_color()
          });
          // 随机颜色
          function rand_color() {
            return "rgb(" + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + ")"
          }
          //在body添加这个标签
          $("body").append($i);
          //animate() 方法执行 CSS 属性集的自定义动画。
          //该方法通过CSS样式将元素从一个状态改变为另一个状态。CSS属性值是逐渐改变的，这样就可以创建动画效果。
          //详情请看http://www.w3school.com.cn/jquery/effect_animate.asp
          $i.animate({
            //将原来的位置向上移动180
            "top": y - 180,
            "opacity": 0
            //1500动画的速度
          }, 1500, function () {
            //时间到了自动删除
            $i.remove();
          });
        });
      })
      ;
    </script>
  


<!-- Functions -->
<script type="text/javascript">
  /* 切换背景 */
  
    $("body").removeClass("banner-bg");
    $("#background").addClass("banner-bg");
    $('#mainContent').removeClass("rgba-black-slight");
    $('#footerContent').removeClass("rgba-black-slight");
    if (/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent) || (/Safari/i.test(navigator.userAgent) && !/Chrome/i.test(navigator.userAgent))) {
      $("#background").css("background-attachment", "scroll");
    }
  
</script>

  <script type="text/javascript">
    /*显示博客运行时间*/
    var blogRunTime = function () {
      var runTime = document.getElementById("runtime");
      var runtimeDate = "2019,04,20";
	    var createDate = new Date(runtimeDate);
	    var nowDate = new Date();
	    var dateLine = nowDate.getTime() - createDate.getTime();
	    var runDate = Math.floor(dateLine / (1000 * 60 * 60 * 24));
	    runTime.innerHTML = runDate;
    };
    $(document).ready(function(){
	    blogRunTime();
    });
  </script>




 
 
 
 
 
 

  
</body>
</html>